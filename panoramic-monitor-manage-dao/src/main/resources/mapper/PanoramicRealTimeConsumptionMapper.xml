<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.monitor.mapper.realtimeconsumption.PanoramicRealTimeConsumptionMapper">
  <resultMap id="baseResultMap" type="com.monitor.model.realtimeconsumption.PanoramicRealTimeConsumption">
    <!--
      WARNING - @mbg.generated
    -->
    <id column="id" jdbcType="INTEGER" property="id" />
    <result column="name" jdbcType="VARCHAR" property="name" />
    <result column="code" jdbcType="VARCHAR" property="code" />
    <result column="value" jdbcType="DOUBLE" property="value" />
    <result column="unit" jdbcType="VARCHAR" property="unit" />
    <result column="delete_flag" jdbcType="INTEGER" property="deleteFlag" />
    <result column="ctime" jdbcType="TIMESTAMP" property="ctime" />
    <result column="utime" jdbcType="TIMESTAMP" property="utime" />
    <result column="dtime" jdbcType="TIMESTAMP" property="dtime" />
    <result column="operator" jdbcType="VARCHAR" property="operator" />
    <result column="f_id" jdbcType="VARCHAR" property="fId" />
  </resultMap>
  
  <select id="selectSummaryConsumptionByCondition" resultType ="com.monitor.model.realtimeconsumption.PanoramicRealTimeConsumption">
  <![CDATA[
  	select 
  		sum(value) as value,
  		name,
  		utime,
  		f_id,
  		ctime,
  		delete_flag
  	from
  		panoramic_real_time_consumption
  	where
  		substring(code, 1, 12) = #{code} 
		AND f_id=2 
		AND delete_flag=1 
		AND value > 0  
		AND utime >= #{dateBefore}
		AND utime < #{dateEnd}
  ]]>
  </select>
  
</mapper>